// GENERATED FILE FROM MODEL ./models/mlp.pth
// Info: Neural network for the 2.1 Crazyflie
#include "nn.h"
#include "nn_utils.h"


struct NeuralNetwork
{
    float layers_0_weight[12][16];
    float layers_0_bias[16];
    float layers_0_activation[16];
    float layers_2_weight[16][16];
    float layers_2_bias[16];
    float layers_2_activation[16];
    float layers_4_weight[16][6];
    float layers_4_bias[6];
    float layers_4_activation[6];
    float scaled_output[6];
    float mins[6];
    float maxs[6];
};

struct NeuralNetwork mlp = {
    .layers_0_weight = { { 1.59517735e-01, 1.25047311e-01, 1.38310805e-01, 3.22838277e-01, 4.09058213e-01, 7.49100670e-02, 3.13405931e-01, 7.01540262e-02, -5.50613642e-01, -5.84546983e-01, -5.04248083e-01, 1.66168913e-01, 1.00982212e-01, 1.52801991e-01, -9.97415185e-02, -8.71158987e-02 }, { 1.74857423e-01, 1.73766315e-01, -4.84675974e-01, 4.57008749e-01, 3.66647989e-01, 4.98554945e-01, 3.97933662e-01, 2.07495928e-01, -1.90777957e-01, -4.31601465e-01, -5.85616902e-02, -1.78462654e-01, 1.94591373e-01, 2.65956461e-01, -2.36564558e-02, -7.83609152e-02 }, { -5.29065490e-01, -1.06745195e-02, 1.36470929e-01, -3.17781478e-01, -4.57494259e-01, 7.87825048e-01, -7.36973643e-01, -5.11752069e-01, 4.63386923e-01, 5.43474317e-01, 2.08272383e-01, -4.66856837e-01, -4.32059497e-01, 1.03450441e+00, -9.64242667e-02, 2.03460768e-01 }, { -4.52683151e-01, 7.65014708e-01, -4.99524288e-02, -1.03204520e-02, 8.40624496e-02, -1.16995893e-01, -5.88856079e-02, -7.01655865e-01, -3.85503501e-01, 9.02911425e-02, -2.42422312e-01, -1.35234088e-01, -1.19099766e-01, -1.99111123e-02, 1.17138185e-01, -2.12163091e-01 }, { -6.63958549e-01, -2.26518378e-01, -1.18074298e+00, 3.49674344e-01, -4.34323639e-01, -1.32245328e-02, -3.04087728e-01, -4.04563814e-01, 7.17829823e-01, -1.25085974e+00, 5.09737492e-01, -7.24685848e-01, 2.61694402e-01, -2.74988353e-01, 8.00958797e-02, -5.60039021e-02 }, { 1.17040522e-01, -3.71740796e-02, 9.86505300e-02, 2.34327853e-01, -5.06596506e-01, 2.11572483e-01, -1.42793292e-02, 4.51552242e-01, 8.92211199e-01, -5.08355610e-02, 9.19766948e-02, 7.06460839e-03, -5.61156332e-01, 9.59422253e-03, 5.33957183e-01, 1.67021647e-01 }, { -1.85853837e-03, 5.58831403e-03, -2.29585208e-02, -2.43828911e-02, -6.30389107e-03, 9.01896060e-02, 1.87957252e-03, 2.64731282e-03, -1.98287517e-01, 1.68512035e-02, -3.59097437e-04, 6.73062960e-03, 5.78127755e-03, -8.60272069e-03, 8.21358932e-04, 8.78533442e-03 }, { 5.23597598e-02, -2.28724461e-02, -1.03958771e-01, -7.79316723e-02, 5.60064837e-02, 5.82769588e-02, 4.24718782e-02, -4.89758216e-02, 1.68994460e-02, -1.31445095e-01, 2.84688715e-02, 1.37900308e-01, -7.47994408e-02, 1.52144507e-01, -1.05299335e-02, -8.18911567e-03 }, { 1.61863789e-01, 7.92960227e-02, 1.73171479e-02, -2.13464424e-01, 6.62645921e-02, -1.70099601e-01, -4.65409234e-02, 1.36520594e-01, -1.16771534e-01, -2.18242574e-02, 2.50877023e-01, -9.67018008e-02, 2.19986379e-01, -6.08349638e-03, 9.18838382e-02, 1.01071363e-02 }, { 9.72841904e-02, -5.12003414e-02, 2.63032448e-02, -8.66918266e-02, -3.08763012e-02, 2.45135769e-01, 1.37716328e-04, -1.52402773e-01, 1.79006830e-01, -6.12891912e-02, 7.19611645e-02, -3.12140724e-03, -8.59264936e-03, -3.05160694e-02, -9.46900155e-03, -4.17069718e-03 }, { 1.09063527e-02, 5.64152468e-03, -4.24429253e-02, -4.27845027e-03, 7.19121620e-02, -4.16240655e-03, 2.47359052e-02, 2.82655656e-02, -8.12847018e-02, -7.32381409e-03, -5.21498285e-02, -3.60038579e-02, 7.31384195e-03, 2.59239376e-02, 7.58000836e-03, -1.03241108e-01 }, { 3.16585675e-02, 1.35399820e-02, 5.05505130e-03, -3.88602465e-02, 4.29692045e-02, -1.04600839e-01, 1.62332430e-02, 1.38371596e-02, -5.11818714e-02, -7.88117573e-03, -9.76927765e-03, -8.01099557e-03, 5.39221475e-03, -7.89631810e-03, -4.27361112e-03, -6.83755893e-03 } },
    .layers_0_bias = { -0.076070905, -0.13621336, 0.024415886, -0.30391783, 0.62960976, 0.16252342, 0.30766383, -0.11851474, -0.4055377, -0.05691886, -0.37407917, 0.26608405, 0.041485265, -0.030532474, 0.13722359, 0.5562848 },
    .layers_0_activation = { 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0. },
    .layers_2_weight = { { 1.02988750e-01, 1.74834237e-01, 2.21231245e-02, 1.75668955e-01, 1.00461133e-01, -7.85529539e-02, -8.21424127e-02, -1.84556291e-01, 9.12781656e-02, -6.62795734e-03, 1.14798367e-01, 2.43218824e-01, 6.65794984e-02, -4.73399572e-02, -6.62559569e-02, 9.22597870e-02 }, { -9.62774530e-02, -3.75035852e-01, -1.99696064e-01, 1.63211495e-01, 1.36965364e-01, 1.33160740e-01, -5.48155867e-02, 3.50540578e-02, -5.75300455e-01, -1.26490325e-01, -1.51612118e-01, 3.77542675e-02, 9.65655893e-02, -1.62180901e-01, -2.49302834e-01, 1.25220716e-01 }, { -2.70785987e-02, 2.52580568e-02, 2.62643863e-02, 9.16123092e-02, 1.75778255e-01, 9.82410312e-02, 5.63691836e-03, 2.14025546e-02, 1.66922837e-04, -1.58196664e-03, -5.84808253e-02, 5.81178144e-02, 1.91841602e-01, -1.00285418e-01, 3.29419747e-02, -8.88268948e-02 }, { -4.35104966e-02, -1.41038924e-01, -1.75847962e-01, -2.97135636e-02, 1.80931166e-01, -4.55030575e-02, -3.00758500e-02, 8.66632760e-02, 8.93172249e-02, 9.66842473e-02, -1.64896443e-01, -1.83111653e-02, 4.94652875e-02, 4.40020822e-02, 2.08547607e-01, -6.67409599e-02 }, { 2.35357612e-01, -9.68735591e-02, 1.50890604e-01, -9.05035138e-02, 1.99268147e-01, 8.83649960e-02, -5.98244835e-04, 5.22633418e-02, -3.47768515e-01, -3.17960918e-01, 2.42511332e-01, 2.37749770e-01, 3.22742671e-01, -2.85220474e-01, -2.71612126e-02, -2.33991221e-01 }, { 8.72152820e-02, 1.27090558e-01, 6.45602718e-02, 3.27853598e-02, 2.49427687e-02, -7.73424655e-02, 3.30723673e-02, 8.79673809e-02, 2.79731244e-01, 6.76132813e-02, 1.20181821e-01, -3.64664793e-02, 9.98475705e-04, 6.98054135e-02, -2.12128133e-01, 9.05468315e-02 }, { 3.22619416e-02, -3.20975244e-01, -6.63736239e-02, -1.96214423e-01, -8.60271007e-02, 2.14660019e-01, 1.44703358e-01, 9.12185609e-02, 1.49300411e-01, -3.10907155e-01, -2.28688065e-02, -1.26139149e-01, -1.50495112e-01, -1.22715250e-01, 3.13890725e-02, 7.63505399e-02 }, { -7.17965662e-02, 2.93919623e-01, -5.34670474e-03, 1.79308169e-02, -1.58157155e-01, -1.00490991e-02, -1.42742723e-01, -1.48852706e-01, -1.75416246e-01, -1.53516322e-01, -1.45911202e-01, 2.06866294e-01, 4.02340814e-02, -4.46840823e-02, -3.63802575e-02, 7.55848587e-02 }, { 2.08056271e-01, -8.66704807e-02, -1.63392782e-01, 7.26782903e-02, -7.67311230e-02, -1.45817876e-01, 3.10892493e-01, 4.23470214e-02, -4.63356227e-02, -6.06540702e-02, -1.02313370e-01, 2.21993789e-01, -4.04938273e-02, -8.80858954e-03, -2.15147793e-01, 1.09997101e-01 }, { 6.04897961e-02, -9.35845636e-03, 4.84330580e-02, 2.08122119e-01, -6.55114651e-02, 6.01548925e-02, 3.22368555e-02, -6.09427737e-03, 2.22932156e-02, 1.24943048e-01, 5.20100333e-02, -5.20619042e-02, 6.69474772e-04, -9.96905565e-02, 1.27425835e-01, -8.70196242e-03 }, { -1.45300210e-01, 3.84703241e-02, 4.65557389e-02, -1.13468736e-01, -6.74183294e-02, 2.42919177e-01, 2.82260239e-01, 1.36044435e-02, 3.90346348e-02, -1.08743170e-02, -2.98564509e-02, -6.60914928e-02, -2.21900523e-01, 4.73136976e-02, -1.67732477e-01, 1.61412396e-02 }, { -1.97857600e-02, -6.68127239e-02, 1.83698814e-03, 5.73536791e-02, 1.19260184e-01, 1.65146619e-01, 7.72484466e-02, 6.80669248e-02, 1.81894638e-02, -2.22099945e-01, 2.28175223e-01, 2.67486554e-02, -2.11059488e-03, -1.33455306e-01, -1.41439155e-01, 1.83163971e-01 }, { 2.05656767e-01, 2.39993438e-01, 1.32209480e-01, 2.03722790e-01, 8.66499916e-02, -3.64894867e-02, 3.09391737e-01, 2.04548329e-01, 9.98751074e-02, -2.11116225e-01, 1.72237232e-01, -1.95433199e-01, 1.33565202e-01, -1.44225255e-01, -3.86138827e-01, 1.24277942e-01 }, { -1.60558168e-02, 2.14087248e-01, 8.44500214e-02, -8.37763073e-04, 6.23954572e-02, -4.45273817e-02, 4.58434001e-02, -2.43675988e-02, 4.09749746e-02, -2.29391195e-02, 4.40740623e-02, 5.65860234e-02, 5.05877249e-02, -8.79169479e-02, -4.78058010e-01, 1.89861313e-01 }, { -2.42173374e-01, -2.37070888e-01, 1.77425236e-01, -2.66468734e-01, 1.26499906e-01, 7.13476762e-02, -1.69592291e-01, -9.02536586e-02, 1.68269604e-01, -1.91708818e-01, 1.46913841e-01, 4.73646633e-03, -1.96216390e-01, -1.48422733e-01, -1.32958874e-01, 1.22320928e-01 }, { 1.28589720e-01, -1.76187828e-01, 2.56558210e-01, -1.49079666e-01, -1.37032181e-01, -5.84661365e-02, -4.95629311e-02, -2.45029312e-02, 1.13474533e-01, -2.63771057e-01, 2.74383817e-02, -1.16875410e-01, -3.95552889e-02, 3.37129176e-01, -4.11928535e-01, -1.01730069e-02 } },
    .layers_2_bias = { 0.19630419, 0.07185556, 0.38078257, -0.18631674, 0.13024192, -0.56364673, -0.28475365, 0.45963353, -0.22699724, -0.31192786, -0.115297765, 0.15606071, 0.07326455, 0.037385415, -0.15889676, -0.41703337 },
    .layers_2_activation = { 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0. },
    .layers_4_weight = { { -0.123530656, -0.034236703, 0.026127243, -0.18463589, 0.08456585, -0.08031015 }, { -0.011623467, -0.13238859, 0.36221582, -0.05024376, -0.06750091, -0.017217455 }, { 0.08293643, 0.08124901, 0.15349291, -0.012947142, 0.15536034, -0.13578646 }, { -0.006542639, -0.34151766, -0.034805212, -0.021908337, -0.03558624, -0.018920302 }, { -0.06489375, 0.077861466, -0.104018494, -0.22555326, 0.005055179, -0.08179343 }, { 0.059251495, 0.05956413, -0.47929808, -0.024150612, -0.006958354, -0.014685207 }, { -0.12959571, -0.29793203, 0.061331183, 0.07529435, 0.011741066, 0.10617358 }, { 0.053181514, 0.0063578105, -0.119644746, -0.0026314724, -0.051843148, -0.24017715 }, { 0.15518251, -0.13352251, -0.23058414, -0.016143346, 0.019324305, 0.074804984 }, { -0.048737668, -0.14953503, 0.014347964, 0.34849924, 0.2734903, 0.06107272 }, { 0.21031648, 0.16970553, 0.032255016, 0.09873125, -0.09979425, 0.09658562 }, { -0.08007247, 0.3396961, 0.040377256, 0.026302297, -0.03427789, -0.100802235 }, { 0.09273292, -0.40427676, 0.004915107, 0.21898293, 0.01264923, 0.15919323 }, { 0.24279362, 0.048392966, 0.16944526, 0.20037974, 0.0023477934, 0.031573664 }, { -0.009990875, 0.0129962005, -0.22524877, 0.15624864, -0.16383588, 0.30904266 }, { -0.022571959, 0.5156637, 0.01592519, 0.013823861, 0.023190059, 0.009419388 } },
    .layers_4_bias = { -0.04659034, 0.061001208, 0.1256695, 0.091959216, -0.04784922, -0.18832347 },
    .layers_4_activation = { 0., 0., 0., 0., 0., 0. },
    .scaled_output = { 0., 0., 0., 0., 0., 0. },
    .mins = { -1.268202839890139, -1.2266897552858658, -1.6415068784793339, -0.035765885026194155, -0.050201853839098476, -0.029192359070293605 },
    .maxs = { 1.165465008056043, 1.066864280159922, 0.6036519244498346, 0.035134838661178946, 0.04446218235534616, 0.07815751343150623 },
};

const float* nn_forward(float input[INPUT_SIZE]) {
    layer(12, 16, input, mlp.layers_0_weight, mlp.layers_0_bias, mlp.layers_0_activation, 1);
    layer(16, 16, mlp.layers_0_activation, mlp.layers_2_weight, mlp.layers_2_bias, mlp.layers_2_activation, 1);
    layer(16, 6, mlp.layers_2_activation, mlp.layers_4_weight, mlp.layers_4_bias, mlp.layers_4_activation, 0);
    for (int i = 0; i < 6; i++) {
        mlp.scaled_output[i] = (mlp.layers_4_activation[i] + 1) * 0.5f * (mlp.maxs[i] - mlp.mins[i]) + mlp.mins[i];
    }
    return mlp.scaled_output;
};
