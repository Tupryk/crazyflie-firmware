// GENERATED FILE FROM MODEL ./models/mlp.pth
// Info: Neural network for the 2.1 Crazyflie
#include "nn.h"
#include "nn_utils.h"


struct NeuralNetwork
{
    float layers_0_weight[12][16];
    float layers_0_bias[16];
    float layers_0_activation[16];
    float layers_2_weight[16][16];
    float layers_2_bias[16];
    float layers_2_activation[16];
    float layers_4_weight[16][2];
    float layers_4_bias[2];
    float layers_4_activation[2];
};

struct NeuralNetwork mlp = {
    .layers_0_weight = { { -6.30340099e+00, 7.03227711e+00, -8.14963436e+00, -6.24489594e+00, -1.46543131e+01, 1.48538799e+01, 1.04355984e+01, 9.50997162e+00, -4.64733362e-01, -6.37845278e-01, -6.59589195e+00, -5.23856449e+00, 9.79091549e+00, 5.20423985e+00, 3.64562809e-01, 6.45767987e-01 }, { -8.38146400e+00, -2.05927205e+00, -5.75186014e+00, 6.50654674e-01, 6.65413046e+00, 9.50315285e+00, 2.90111637e+00, -6.67004013e+00, -8.51338089e-01, 8.65554452e-01, -1.03242922e+01, 5.62060547e+00, 6.60838366e+00, -1.57499971e+01, 7.35461473e-01, -1.13676064e-01 }, { 2.08884254e-01, -1.23777250e-02, 8.14517289e-02, -2.14897513e-01, 3.35088700e-01, 1.38365969e-01, 2.16198027e-01, 2.07350515e-02, -4.61872131e-01, 3.82054508e-01, 1.40409634e-01, 1.75973717e-02, 1.69291213e-01, 3.48273575e-01, -8.65705431e-01, -5.84327221e-01 }, { 4.51004086e-03, -6.27507048e-04, -9.04017244e-04, -6.40582293e-04, -8.18083412e-04, -2.31311889e-03, 3.61812138e-03, 3.32215428e-03, -6.63849700e-04, 7.35944184e-03, -2.57828645e-03, 4.30046627e-03, -4.75794717e-04, -2.44181766e-03, -6.58461219e-03, -1.71996222e-03 }, { -1.97582063e-03, -2.64396798e-03, 5.16153465e-04, 1.19886792e-03, -4.82996373e-04, 9.37572564e-04, -7.30703876e-04, -3.15474975e-03, 1.40013697e-06, 1.46589400e-02, -4.64977114e-04, -4.83526802e-03, 2.47632340e-03, 1.85825571e-03, -5.63769415e-03, -1.85039581e-03 }, { -2.91120727e-02, 1.32199759e-02, 1.37756057e-02, -5.16131707e-03, 6.84990268e-03, 1.17493588e-02, -2.05164291e-02, -9.59339179e-03, -3.67468484e-02, -7.87817165e-02, 1.50074705e-03, -2.50801966e-02, -1.13303598e-03, 9.97143611e-03, -5.99831380e-02, -2.13266741e-02 }, { 3.54728520e-01, 1.26394331e-01, 3.44849348e-01, -2.39584267e-01, -2.77950913e-01, -1.86315998e-02, 3.61241788e-01, 2.44092181e-01, -3.64197582e-01, -5.76375008e-01, 4.86535370e-01, 5.00474036e-01, -6.45443678e-01, -3.48503679e-01, -5.68448782e-01, -1.88953340e-01 }, { 1.57773867e-01, 7.76547372e-01, 4.68947858e-01, 1.56337410e-01, -1.52170405e-01, -1.39069140e-01, 4.70736861e-01, -2.87354946e-01, -3.96096736e-01, 4.26975638e-01, -7.61901557e-01, 2.51314580e-01, 7.01588690e-01, -9.76551697e-02, -4.07558799e-01, -1.16663635e-01 }, { -8.46942812e-02, -9.41901743e-01, 7.24919513e-02, -7.24495724e-02, -3.39696966e-02, 1.10646188e-01, -4.66750748e-02, -1.02627978e-01, 3.79911624e-02, -4.51286674e-01, 5.72248280e-01, -4.39001322e-01, -7.37716675e-01, 9.70176309e-02, 5.17293155e-01, 2.71697879e-01 }, { 6.13706037e-02, 2.46844500e-01, 4.04296547e-01, 1.81012541e-01, -7.78132319e-01, -5.78303993e-01, 1.70809716e-01, 2.55615622e-01, -1.05874479e-01, -6.86875880e-01, 4.18124527e-01, 5.05878389e-01, -9.20386612e-01, -6.57721281e-01, -7.98407435e-01, 2.11548572e-03 }, { -1.31782126e+00, 7.92038962e-02, -1.41225100e+00, -3.92719358e-02, 2.40158424e-01, -3.99565578e-01, -2.81363988e+00, -9.44415510e-01, 7.12074518e-01, -5.17978311e-01, 1.73976648e+00, 1.22113180e+00, -1.36372566e-01, 4.20975894e-01, 1.92002594e-01, 1.95648253e-01 }, { 2.31439185e+00, 1.65132141e+00, -2.65027016e-01, 3.20099205e-01, 3.42384368e-01, -7.09403038e-01, -3.33568007e-02, -3.27818980e-03, -1.15791500e-01, 3.11352342e-01, -7.62491941e-01, 1.28312588e-01, -5.62754691e-01, 3.10885042e-01, 1.86200708e-01, -6.03170574e-01 } },
    .layers_0_bias = { -0.053576905, -0.16062199, -0.27251932, -0.27634978, 0.33906886, -0.0962003, -0.20994493, -0.22512172, -0.74164414, -0.14196979, -0.022650192, 0.17950214, -0.06979472, 0.20814838, -0.6734315, -0.2600635 },
    .layers_0_activation = { 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0. },
    .layers_2_weight = { { -5.23243919e-02, -2.25942329e-01, -1.24340169e-01, -1.27279356e-01, 9.84550416e-02, -3.91963989e-01, 3.65439922e-01, 3.77171636e-02, 9.73737761e-02, -1.86001286e-01, 2.38120873e-02, 1.10343797e-02, -2.71177609e-02, -1.45598367e-01, 4.60593328e-02, -9.84911919e-02 }, { -5.54338805e-02, 6.34479746e-02, -1.23500332e-01, -4.16195467e-02, -3.15630212e-02, 2.13054307e-02, 8.51347372e-02, -2.00506493e-01, 9.49174240e-02, -8.10168684e-02, 1.58515319e-01, 6.80562481e-02, 1.29622370e-01, -2.30678208e-02, 5.44297788e-03, -3.88955604e-03 }, { 1.15344845e-01, -3.98187339e-02, -5.08881696e-02, -4.85512428e-02, 2.51378324e-02, 1.94843765e-02, -7.52273738e-01, 5.18273003e-02, 8.89998525e-02, -1.39726818e-01, -1.12871945e-01, 8.85134339e-02, -3.22980821e-01, -1.66967645e-01, -2.04131790e-02, 1.29133910e-01 }, { -1.43091530e-01, 1.87294602e-01, 6.90039620e-02, 1.54853091e-01, 6.85566887e-02, 4.99713346e-02, -1.36072114e-01, 9.06871781e-02, -1.52658209e-01, -7.25656450e-02, -8.85701105e-02, -1.71022207e-01, -4.99941641e-03, -1.78939074e-01, -1.39220655e-01, -3.79862003e-02 }, { 3.00929714e-02, -2.08665088e-01, -2.03508958e-01, 2.50186533e-01, 5.82108423e-02, 9.47023630e-02, -1.33262262e-01, -7.72510096e-02, -6.07534423e-02, 1.87114570e-02, -5.66168167e-02, -2.29716584e-01, -7.37069324e-02, -1.16688877e-01, 1.74801156e-01, 8.55070204e-02 }, { 2.85944194e-02, 2.15402201e-01, 4.66531180e-02, 2.57035829e-02, 4.70347470e-03, 1.49484769e-01, -6.00806996e-02, -6.99143559e-02, -3.02987665e-01, -1.33178473e-01, 9.37305614e-02, -7.57866576e-02, -5.21562099e-01, 2.18311250e-01, -1.54635534e-01, -1.79635826e-02 }, { 1.20181225e-01, -1.21666333e-02, 1.74010828e-01, 2.30919033e-01, -2.08417371e-01, 3.01347207e-02, -4.51036617e-02, -2.37270389e-02, 3.15793544e-01, -1.57401711e-01, 8.58836845e-02, 1.54921664e-02, 6.92790896e-02, 5.19278683e-02, 5.42343631e-02, 1.25449270e-01 }, { 3.05759013e-01, 1.80118427e-01, -8.25636461e-02, 3.49197872e-02, -1.27263024e-01, 1.56622052e-01, 5.58850430e-02, -4.89289872e-03, -2.32333899e-01, 1.91402957e-01, 2.58862346e-01, 1.30831569e-01, -7.56364524e-01, 7.07914680e-02, -7.87092447e-02, 1.57775223e-01 }, { 6.41245618e-02, -8.55277013e-03, -1.08663790e-01, -6.63221702e-02, 8.94262046e-02, -2.36889236e-02, 1.00560658e-01, 9.10344943e-02, -1.54617921e-01, 1.57525260e-02, 1.12324528e-01, 1.73691362e-01, 4.94891824e-03, 5.98179922e-02, 1.84834212e-01, 4.54568528e-02 }, { -3.77349317e-01, -3.89834270e-02, 4.74873884e-03, 1.31276727e-01, 1.23963274e-01, -2.49932241e-02, -5.52263975e-01, -1.78893998e-01, -6.28979318e-03, 1.02846548e-01, -3.32219042e-02, -2.27071141e-04, -6.70408085e-02, 3.31472568e-02, -1.17807975e-02, 1.22006394e-01 }, { -1.37255147e-01, 8.97801444e-02, 1.25557691e-01, 1.43110842e-01, -7.78094456e-02, 1.68805897e-01, -1.35099366e-02, -2.27879405e-01, -1.76755205e-01, -7.09377453e-02, -8.52354616e-02, 1.38404176e-01, -1.14617693e+00, 5.07866219e-03, -4.27220166e-02, -1.32480234e-01 }, { -2.67471164e-01, -7.81716257e-02, 4.16323505e-02, -7.37366974e-02, 2.12299749e-01, 8.06768686e-02, -7.89734349e-02, 1.64845422e-01, -1.31665275e-01, -4.09241803e-02, 1.09159298e-01, 7.97622371e-03, 2.62266666e-01, -2.52586693e-01, -5.89366443e-02, 4.06663604e-02 }, { 5.73307388e-02, -8.31013769e-02, -6.25948459e-02, 1.26687288e-01, 3.22151445e-02, -1.97085813e-01, -1.79378569e-01, -9.01503265e-02, 1.14919007e-01, -3.54792446e-01, 3.59113738e-02, 9.97998044e-02, -8.33979808e-03, 2.07845625e-02, 5.62046245e-02, 9.75575671e-02 }, { -1.05739474e-01, -1.01322487e-01, 3.15523893e-01, -9.79952961e-02, -3.52334883e-03, -2.90350109e-01, 5.10624684e-02, 6.73611984e-02, 1.80373326e-01, -9.05575529e-02, -9.48902294e-02, 7.50085339e-02, -1.75328739e-02, 7.60065168e-02, 7.78544396e-02, -1.85010344e-01 }, { 1.19271591e-01, -2.66910084e-02, -1.51412174e-01, -3.66078131e-02, 1.03670098e-01, -2.67084017e-02, -1.08888626e-01, 2.44797077e-02, -7.96368495e-02, -5.24341166e-02, 1.44642353e-01, 8.57241079e-02, -1.07840925e-01, 1.34619370e-01, 2.01398596e-01, 6.08391613e-02 }, { -1.41536102e-01, -1.53957650e-01, 2.52724648e-01, 1.40506849e-01, -1.49611443e-01, 2.60928035e-01, 9.97605324e-02, -3.53961475e-02, 2.08848819e-01, 1.47111878e-01, -2.05281943e-01, -1.20550364e-01, 1.69580728e-01, -2.64983010e-02, 1.55452639e-01, -1.83113158e-01 } },
    .layers_2_bias = { 0.070659004, 0.22754729, 0.017403329, -0.18548335, 0.08993858, 0.04031887, 0.10922932, 0.140908, -0.0054478664, -0.4003484, 0.03624928, -0.007712984, -0.23852602, -0.032320246, -0.039510433, 0.17393169 },
    .layers_2_activation = { 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0. },
    .layers_4_weight = { { -0.008313225, -0.028890518 }, { 0.03367904, 0.023915812 }, { 0.022084512, 0.016380556 }, { 0.0025310162, -0.042212676 }, { -0.023316884, 0.005962618 }, { -0.035206594, 0.02065207 }, { 0.017657522, 0.033582337 }, { 0.00026846462, 0.04619598 }, { -0.032130715, 0.010298096 }, { 0.016450867, 0.030074911 }, { 0.014573887, -0.027111895 }, { -0.0007414018, -0.041837707 }, { 0.030799594, 0.009483507 }, { -0.03647057, 0.00810536 }, { 0.037221014, 0.032481454 }, { 0.035297006, 0.038045168 } },
    .layers_4_bias = { -0.0065981, -0.006443087 },
    .layers_4_activation = { 0., 0. },
};

const float* nn_forward(float input[INPUT_SIZE]) {
    layer(12, 16, input, mlp.layers_0_weight, mlp.layers_0_bias, mlp.layers_0_activation, 1);
    layer(16, 16, mlp.layers_0_activation, mlp.layers_2_weight, mlp.layers_2_bias, mlp.layers_2_activation, 1);
    layer(16, 2, mlp.layers_2_activation, mlp.layers_4_weight, mlp.layers_4_bias, mlp.layers_4_activation, 0);
    return mlp.layers_4_activation;
};
