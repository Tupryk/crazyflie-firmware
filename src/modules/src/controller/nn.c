// GENERATED FILE FROM MODEL ./models/mlp.pth
// Info: Neural network for the brushless Crazyflie with a payload
#include "nn.h"
#include "nn_utils.h"


struct NeuralNetwork
{
    float layers_0_weight[12][16];
    float layers_0_bias[16];
    float layers_0_activation[16];
    float layers_2_weight[16][16];
    float layers_2_bias[16];
    float layers_2_activation[16];
    float layers_4_weight[16][2];
    float layers_4_bias[2];
    float layers_4_activation[2];
};

struct NeuralNetwork mlp = {
    .layers_0_weight = { { -7.6963014091802489e+00, -5.8808151618482754e+00, 7.0830951915978666e+00, 7.9351173871269260e+00, -2.3538533784451663e+00, 1.1582993780827740e+01, -6.5325271903377438e+00, 8.3294885750119256e+00, 6.2954154597818803e+00, -1.0825513905931398e+01, -4.3145664590327808e+00, -8.1296534594853238e+00, 9.1745664608185162e-01, -7.0116710852637310e+00, -8.7781336715152847e+00, 6.9311940160929382e+00 }, { 7.2452433482682199e+00, 9.1750610973834874e+00, -7.5706213542454632e+00, 6.7271839519292982e+00, -1.0537591465733975e+01, -1.1300109565828731e+00, -9.0958070863960430e+00, 7.3385191361551261e+00, 6.9690082904603878e+00, -5.3241172702841277e+00, -8.2401589430010738e+00, 8.9261195213620130e+00, -5.4976312937896221e+00, 1.8704097401484645e+00, -3.0295069722324675e+00, 5.2340962525051609e+00 }, { 1.1143405259676867e-01, 1.2524645140064556e+00, -2.6420745618299468e-01, -5.0608623712750966e-01, -1.5031135030964082e+00, 1.0512862286190043e+00, 1.2478046860638790e+00, 4.5945117302057842e-01, -4.7476118719436983e-01, -2.0477047767204862e-01, -1.4462359503488245e-01, -3.5975632461508428e-01, -1.7584523625715023e+00, -1.5108939861217514e+00, -1.2723071598766815e+00, -5.9429754266131551e-01 }, { 1.1581698658006904e-03, -4.4737173908706114e-03, -1.1662959160978843e-03, -2.3788655858558386e-03, 7.0769709201388281e-04, -3.6153242863908594e-03, -6.9888454271836119e-03, -3.2678209144961588e-03, -5.8899876445499240e-03, -1.9720973856982703e-02, 1.9152301689464000e-02, -8.4433990119994344e-05, -2.7089759408700930e-03, -3.3371014071133687e-02, -1.7650400492284202e-03, 3.3701180916212549e-03 }, { 4.0948645561056186e-02, -5.0540292804497080e-04, 1.1541706260182558e-02, 2.6241830928661210e-03, -6.9657168157075252e-03, -1.6345239934182330e-03, -3.5601359507859216e-04, -1.0013424211756489e-03, -7.7037554298279593e-03, -2.3499972336518012e-02, -4.6929921948372375e-03, -7.0059402364590351e-03, 1.2406056163938431e-02, -2.8830336984160586e-03, 6.9509323812333467e-04, 6.3950578123467411e-03 }, { 3.2924830104748455e-02, -1.9773922197696128e-03, 5.9550132972477207e-03, -1.1755180671597410e-02, -3.4479992317109319e-03, -8.2520901557028709e-03, -2.3858251926990614e-03, 1.5754064413945720e-02, 5.6024763773129406e-02, 3.9728166082673121e-02, -3.0938982355282994e-02, -1.7247553924747711e-02, -1.1248139474367354e-01, -2.0086428933563709e-02, 6.6529724139146890e-04, -1.3650892000283341e-03 }, { -1.0976590114135782e-02, -4.5719736174984826e-01, -5.1561740735728834e-02, 5.0849537934304648e-02, 6.1254906261963471e-01, -2.7565547895412018e-01, -7.9711769478783126e-02, -2.8016425828752606e-01, -5.7890517512076234e-01, -4.1592224253291993e-01, 6.0163778576385274e-01, 5.2156476693816911e-01, 2.7928764086532898e-01, -9.0167021003801406e-01, 7.3781423162905579e-01, 3.0598248199841488e-01 }, { 6.0654547617592085e-02, -1.5652121006445174e+00, -2.3609333203054459e+00, -8.2179478604895795e-01, 1.3543768515114007e+01, -4.8469183113488326e+00, -2.2012847760524745e+00, 1.3090535749765388e+00, 4.3496718458119030e+00, -4.4804584166255417e+00, 3.5920511367676844e+00, 7.3309440741846741e+00, -3.4587294894276441e+00, 3.3202421534697932e+00, 3.8890853100445493e+00, 1.4753998630519294e-01 }, { -1.9200403568381530e+00, 2.9156187001530642e+00, -1.0430698881076712e+01, -3.7392749822439864e-01, -1.0776979623587023e-01, -7.2892316931860179e+00, -2.1983243499161245e+00, 2.0951933218496799e+00, 2.5755130243292008e+00, -2.5867894610681521e+00, -6.2376952084580339e-01, -2.1507155578226245e+00, 9.4985426703432640e+00, 4.1886130339006229e+00, 5.2089398737478607e+00, 1.7727470292633289e+00 }, { 1.2124336933647549e-01, -2.6437877413930744e-01, 4.9859846859563189e-01, 1.5362451960279755e-01, 2.6210205436850764e-01, -5.5398828475470918e-01, -4.7262838506768079e-01, -1.0821418264354186e+00, -1.3315567910169895e-01, 7.8383659463846678e-02, -1.6834435393962535e-01, 1.7661639342485091e-01, 1.1341197758787958e-01, -1.0782612982699085e+00, 1.3660920387644987e-01, 2.6804532334993270e-01 }, { 2.4008839705252480e+00, -3.2175401110491180e+00, -1.8207911354733297e+00, -9.2314899169033282e+00, 5.3588616345850557e+00, -1.0302643933959656e+00, -5.3146723151044573e-01, -9.8289900846537737e-01, 4.6286154519299769e+00, -2.3531506507947331e+00, -1.3400579208149999e+00, -3.7394185428610927e-01, 2.8831568237674245e+00, -4.6103759969976732e+00, -2.0981398064133332e+00, -9.9418628640193615e-02 }, { 1.8092398559939651e-01, -1.5435778213601830e+00, -1.8132920913193227e+00, -5.3395110321225003e-01, -2.4019698744496332e-01, 1.6829837105616763e-01, 1.0042827411410122e+00, 1.0243370530515572e+00, -2.5773224813425202e+00, -6.0164431256649020e-01, -1.0825224329490182e+00, 2.2222524566011606e+00, -8.8414883432636326e-01, 3.7214792615294923e+00, -1.5842358232603493e+00, -4.9145750947007318e+00 } },
    .layers_0_bias = { -0.12315287751339966, -0.5379059891408978, -0.006709970279837397, 0.07132645822396472, 0.27861646398262624, -0.24844320986632365, -0.4688277997738404, 0.32460924547796777, -0.10800030480199312, -0.2644013626731785, -0.07898668288109842, 0.6366828402618099, -0.09715554331967233, -0.6740882157982608, 0.6193658632661911, 0.5383243835237294 },
    .layers_0_activation = { 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0. },
    .layers_2_weight = { { -6.7974425047776205e-02, -1.1493272712964410e-01, 2.0969746248988932e-03, -1.4084026889180501e-01, -9.6755035303187159e-02, -4.6229676692929954e-02, -1.1228766623438485e-01, 3.9796928477521906e-02, -2.3487691498655194e-01, -1.8825636667935372e-01, 6.4292620601379441e-02, -2.5088498938957187e-02, -9.5751207588320397e-02, -3.2300044838814275e-02, -3.9566809446858649e-03, 3.4780415358282447e-02 }, { 1.9426965091451950e-01, -1.6009771183881874e-01, -1.6520030821601864e-01, 1.1624781676464155e-01, -7.1980531526690442e-02, 1.9852251702721121e-01, 3.0547825919480476e-01, -2.1083091458449746e-01, 1.5493890306046265e-01, 2.9148242925352452e-01, -1.5958138972051883e-01, -7.1301159010452517e-02, -5.5552500245881466e-02, -1.7491436937262139e-01, -2.1565531531928009e-01, -7.9075035007845948e-02 }, { 1.9639715444988690e-01, 1.1191371822047106e-02, -1.9309452767543548e-03, -1.6566552139102364e+00, -7.7309794377613400e-02, 1.6468125879866663e-01, -1.2065551279696378e-01, -8.0842881651515919e-01, 2.2354984295835417e-02, 1.1528042878200481e-01, -3.5300085404434889e-01, -1.9892764581857880e-01, -1.9602711193425160e-01, -5.3908451281093817e-01, -7.9091224225178641e-02, -3.3339652641467474e-02 }, { -1.4687738288075605e-01, -9.3965984136082967e-02, 1.0381018642637889e-01, -8.6048814892908235e-02, -2.0456671123897634e-02, 1.1172531280440541e-01, 1.1731263035277081e-01, -7.3060660331255323e-01, -4.9473262526314749e-01, -1.9703555763675060e-01, -5.0484710790206472e-02, -2.3090133434170844e-02, 1.0746936933669546e-01, -1.4523736684513311e-01, 6.8625232014399892e-02, 3.0759006939287861e-02 }, { -3.8681214950863763e-01, 8.8352174270814779e-02, 3.3790061630519663e-01, -2.0280781276887513e-01, 3.1552776510938429e-01, -3.0345856680754663e-01, -1.4657921807739821e-01, -5.6812675567784597e-02, -5.0703518173867101e-01, -1.3830199647210237e-01, -4.7272663967928029e-02, -1.2279940503242731e-01, 6.3179919235551524e-02, -4.6521684053470802e-01, 2.1413719382660898e-01, -6.8833732085248178e-01 }, { 1.8407646709758141e-01, 1.6420374881937094e-01, 9.6811042496531066e-02, 1.4349395827700742e-01, 9.5491182753458421e-03, 8.6428500067725289e-02, -2.0805874624304663e-01, -6.1441456361417679e-01, 1.4915895441242064e-01, 3.3071156289493475e-01, 8.5786687196438893e-02, 1.0831537382431583e-01, -3.9542906391685798e-02, 1.1871529228264746e-01, -1.5998070174233475e-01, -5.1819848981594979e-03 }, { -5.2947861876955452e-02, -7.9624886672056971e-02, -1.7801496486949221e-02, 3.7745162886390321e-02, -1.2642336596503909e-01, -2.8629529765706535e-01, 2.7227247998169276e-02, 1.3027283396886677e-01, 1.9263194932517766e-01, 1.6853726663438887e-01, -6.0915289553578877e-01, 1.1323401665997559e-01, 1.6455730656650371e-02, 7.1415060877248141e-04, -3.2782991606369155e-01, -2.4073427362986272e-01 }, { -1.6621806072909071e-02, 2.6710654481662205e-01, -2.8841646464520008e-02, -4.4682111284771120e-01, 1.1068327707086188e-01, -5.7934305490671446e-02, -2.5155483649737370e-01, -7.9445533282614708e-02, -2.9140006476647601e-01, -3.0874305214420261e-01, -1.5755138080890591e-02, -1.2099525729424589e+00, -3.0681613851820166e-01, 2.0955653401408086e-01, -4.6269916572827985e-04, 1.8926952015444476e-01 }, { 2.8647304243964145e-01, 6.7629100175855217e-02, -4.4285993884151706e-02, -3.6997564881610956e-01, 4.1662306345127575e-02, 5.9026147252568290e-03, 8.9413634064935271e-02, 7.5769207816940978e-02, -3.1114851974563706e-01, 1.0821041043592032e-01, 9.2198725926450342e-02, 2.4208143450093599e-02, -8.2368609384739042e-02, -1.5618957271932421e-01, 1.0475687794886396e-01, 4.4071310975921579e-01 }, { -1.0854894464145798e-01, 8.1608788747963443e-02, 1.1908897467840697e-02, 4.0771817974729993e-02, 5.6419149440071599e-02, 1.8797277205514099e-01, -1.1398113136177181e-01, -1.1671562086602418e-01, -5.0526399461659141e-02, -6.9710066388485911e-02, -8.4255285893992726e-02, -1.5234687973835434e-01, -6.0952256660399473e-03, -1.9850270537800271e-01, -6.3771411453741114e-02, -4.2037260114560892e-03 }, { 1.4987575276815759e-01, -2.2865564751191197e-02, 1.9646539775401307e-03, -3.5753309181257818e-02, 3.5638013169227697e-02, -3.0451451179539901e-01, 7.6225586103735213e-02, -4.8272695194334940e-03, 1.3509212561164088e-01, 1.8949657174344947e-01, -1.2298431805567089e-01, -1.3886194496595294e-02, 5.7921926455730244e-02, -2.7836318819364281e-01, -1.3089048203286582e-01, 1.2037660709946180e-02 }, { -3.4121839618449015e-02, -1.2091573706798875e-01, -1.3725392256102850e-01, -2.3588497239484801e-01, -2.0854081353065091e-02, -9.8408359793740252e-01, -6.3879583862127026e-02, 2.7489237846190662e-01, -5.2757577467728045e-01, -2.8927436207988749e-01, 1.1908820994994371e-01, 2.4194329113283861e-01, -2.4711586141976974e-01, 2.0251517922617296e-01, 1.0974903763536795e-01, 8.0620375662800906e-02 }, { -1.7456729256888445e-01, 3.8307825396781424e-02, 4.8413151080247664e-02, 4.3275864790557781e-03, 4.9188109153494253e-02, -1.5617201312365658e-01, -6.3846308437924895e-02, 2.5771687152009417e-02, -4.4909899261173181e-01, -1.8275246793481581e-01, 8.9590658787639544e-03, -4.8305433351214004e-02, 6.8975450353388951e-02, 7.7800369588668428e-02, 1.7546367833156515e-01, -1.2295365657661533e-01 }, { -6.5932679066091870e-01, 1.2752428484815942e-01, 9.4433221707044518e-02, -2.8354395700293189e-01, 1.1778063452380644e-01, -1.0967502152707549e-01, 3.1169153729086147e-02, 1.5668485125523229e-01, -3.5738014830950138e-01, -1.4873040334920531e-01, -1.6537958830744468e+00, 8.6511266218315730e-02, -2.0934759981241627e-01, 2.2520460074762133e-01, -9.2442329915532295e-01, -9.5964490886641871e-02 }, { -2.8024644012306782e-01, 2.0776538797556875e-02, 4.0752021277803981e-02, 5.0486054583475060e-01, 1.8955311359327270e-01, -1.4517993030905356e+00, 7.0137157508402877e-03, 8.9693064088415611e-02, 1.3462812872848356e-01, 7.5274873206606710e-02, -9.8005357476397978e-02, 2.4060300322923864e-01, 4.3668687864076944e-01, 1.0326376440885571e-01, -4.3794970947060508e-01, 9.7613820281889085e-02 }, { -2.3455684162558110e-01, 1.0478062773815802e-01, -2.1375475951166709e-01, 1.8178058437464945e-01, 1.1523522514170173e-02, -6.9177337977442507e-02, 6.8700162795927347e-02, 1.0939657016220430e-01, -5.6097246373885065e-02, 3.7672151395300703e-02, 5.5859316659834929e-02, 2.1868742011491477e-01, 1.0502871934731056e-01, 3.4684492607573286e-01, 1.0263665276181766e-01, 3.8105434736669462e-02 } },
    .layers_2_bias = { 0.23187974954926355, 0.17553164362376536, 0.10966457010936705, -0.7662543532049533, 0.03093784875637729, -0.021579491603995162, 0.15598413304396566, -0.3307195570495549, 0.19564404935515697, -0.5727808543680932, 0.07790727343059814, -0.4815848515567408, 0.28603128494436975, -0.3947078050257246, 0.07404004387777369, -0.06175941898639828 },
    .layers_2_activation = { 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0. },
    .layers_4_weight = { { 0.020101956793599347, -0.03600774027364834 }, { 0.0367219423520105, 0.0045473075059876515 }, { -0.006733717901752776, -0.030208200870242813 }, { -0.008818811625970056, 0.0451617768724131 }, { -0.03884569372741606, 0.015983355115572712 }, { 0.04808378423299024, 0.004353244256012237 }, { -0.0002362687656781301, 0.04246040614156691 }, { -0.0339865337336386, 0.03645362490261391 }, { -0.006982418668754335, 0.0615835917169491 }, { 0.015676632349290415, -0.052239579966277594 }, { -0.034003213290416175, 0.015247131996055551 }, { 0.00828310826962546, -0.07804941520687945 }, { -0.008771094755949662, -0.049255766616481116 }, { 0.011157052231532103, 0.04916088006890983 }, { 0.05034753570611699, 0.009672505210110814 }, { 0.0023854077300406273, 0.026368793142435423 } },
    .layers_4_bias = { -0.0012924402420096011, 0.002065689293504415 },
    .layers_4_activation = { 0., 0. },
};

const float* nn_forward(float input[INPUT_SIZE]) {
    layer(12, 16, input, mlp.layers_0_weight, mlp.layers_0_bias, mlp.layers_0_activation, 1);
    layer(16, 16, mlp.layers_0_activation, mlp.layers_2_weight, mlp.layers_2_bias, mlp.layers_2_activation, 1);
    layer(16, 2, mlp.layers_2_activation, mlp.layers_4_weight, mlp.layers_4_bias, mlp.layers_4_activation, 0);
    return mlp.layers_4_activation;
};
