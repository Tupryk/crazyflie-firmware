// GENERATED FILE FROM MODEL ./models/mlp.pth
// Info: Neural network for the 2.1 Crazyflie
#include "nn.h"
#include "nn_utils.h"


struct NeuralNetwork
{
    float layers_0_weight[12][16];
    float layers_0_bias[16];
    float layers_0_activation[16];
    float layers_2_weight[16][16];
    float layers_2_bias[16];
    float layers_2_activation[16];
    float layers_4_weight[16][6];
    float layers_4_bias[6];
    float layers_4_activation[6];
    float scaled_output[6];
    float mins[6];
    float maxs[6];
};

struct NeuralNetwork mlp = {
    .layers_0_weight = { { -8.53025317e-02, 2.04735607e-01, -3.47589582e-01, 2.74409711e-01, 3.62562120e-01, 2.08552286e-01, 5.85625181e-03, -6.48500621e-02, 2.75852412e-01, -8.62228692e-01, 4.74967748e-01, -5.27869344e-01, 6.15839735e-02, -5.85219145e-01, -9.06878989e-03, 1.46824643e-01 }, { -2.97524065e-01, -2.09977366e-02, -4.11708839e-03, -1.72668219e-01, -8.41765925e-02, 1.99041501e-01, -1.77186102e-01, -4.99891900e-02, 9.20213282e-01, 1.70439675e-01, 1.03988183e+00, -8.22639287e-01, -5.84986866e-01, -2.31668860e-01, -4.06056255e-01, 1.79736853e-01 }, { -6.42583817e-02, -6.09700531e-02, 4.91622359e-01, 8.04444700e-02, 1.65273145e-01, -3.97568315e-01, -2.43702292e-01, 5.29495925e-02, 6.11515567e-02, 1.53035313e-01, -3.41745853e-01, 8.44854861e-02, 1.34914607e-01, -2.58428007e-01, 8.64918590e-01, 4.89556603e-03 }, { 3.89960669e-02, 2.74278194e-01, -2.26413801e-01, -2.08740495e-02, -3.04701418e-01, -3.23381037e-01, 3.13245058e-02, 4.23133411e-02, 1.57496303e-01, -3.50765884e-01, 3.88978161e-02, -5.78580916e-01, -1.21543221e-01, -2.09137797e-01, -3.64698082e-01, 6.65134251e-01 }, { 2.68754959e-02, 2.91471899e-01, 3.97054493e-01, -1.67684510e-01, 7.05973897e-03, -4.01460350e-01, 5.63967675e-02, -4.23726514e-02, -2.80673593e-01, -5.68979859e-01, -4.85930502e-01, -2.24634424e-01, 1.04094975e-01, 2.80173331e-01, 7.71498740e-01, -1.42289534e-01 }, { 6.61900416e-02, 2.40952209e-01, 3.27769786e-01, 1.62324429e-01, 1.98024586e-01, 2.22478330e-01, 5.81740513e-02, 8.91823545e-02, -1.10483333e-01, -1.97020620e-01, 1.64607614e-02, 3.88101786e-01, 1.63833007e-01, 2.33798355e-01, 3.20281327e-01, 5.59035949e-02 }, { -3.89873125e-02, -3.67321298e-02, 2.32703220e-02, 2.32261196e-02, 2.84496527e-02, 4.38837670e-02, -5.67456484e-02, -1.17395818e-02, -2.19701268e-02, 2.21913774e-02, 3.68271545e-02, 3.67307104e-02, 9.52114351e-04, 3.65914479e-02, -1.13640688e-02, -2.11204160e-02 }, { 1.21448003e-01, -1.08047403e-01, 3.67549434e-02, 4.41625006e-02, 3.29329196e-04, 3.88322473e-02, 1.42690569e-01, 6.65993318e-02, -1.19203888e-01, -5.43584004e-02, -8.77003893e-02, 1.17168173e-01, 9.54647362e-02, -2.84125004e-02, 4.25350256e-02, -9.59038362e-02 }, { 1.13410890e-01, -2.73806512e-01, 1.62467524e-01, 1.25297517e-01, 1.44456908e-01, -1.76788867e-01, 1.90906703e-01, 1.10601291e-01, -3.88025083e-02, -8.16173181e-02, 1.56679049e-01, -1.37403965e-01, 1.46332309e-01, -1.03373349e-01, 6.82428181e-02, -2.74376988e-01 }, { -6.17732592e-02, 2.23873198e-01, 1.69095080e-02, -2.14177698e-01, 4.17588651e-02, -1.15469426e-01, -4.29781675e-02, -1.90648600e-01, -7.08340406e-02, 1.24484994e-01, -1.37064666e-01, -6.06955923e-02, -1.26887813e-01, 1.52707249e-01, -3.83961871e-02, 1.60167903e-01 }, { 1.90136820e-01, -2.99044102e-02, -1.03603445e-01, 4.76828218e-02, 1.20032439e-02, -1.06439069e-01, 2.22184315e-01, 6.43502399e-02, 6.31424114e-02, -2.67485101e-02, -6.08342607e-03, 6.74527064e-02, -6.97002709e-02, 2.56180600e-03, -1.29409015e-01, -2.48498581e-02 }, { 7.82850757e-02, 2.79920757e-01, 1.13207892e-01, 1.76367253e-01, 1.33773968e-01, 1.38905331e-01, 9.56135914e-02, 1.26276553e-01, -2.93768779e-03, 2.99038023e-01, 2.42896691e-01, 3.21154833e-01, 9.68893245e-02, -1.76135406e-01, -1.33591190e-01, -2.35083010e-02 } },
    .layers_0_bias = { 0.30172423, -0.09806777, -0.3269637, -0.22960289, 0.1053977, -0.1648774, -0.21915998, 0.22744305, 0.06683681, -0.44901234, 0.03732647, -0.2540277, 0.10446945, -0.36812738, 0.47398606, 0.18028829 },
    .layers_0_activation = { 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0. },
    .layers_2_weight = { { -0.19896589, -0.17839722, -0.15778384, 0.09064765, -0.079659246, 0.21366574, -0.09626405, 0.11820199, -0.14265838, 0.09837449, 0.1359629, -0.09887683, -0.18001151, -0.04388106, -0.051013812, -0.20080823 }, { -0.1968539, -0.06782024, -0.24928214, -0.0008090056, -0.35109174, 0.3101658, -0.19032726, -0.012966037, 0.15514624, -0.030399183, -0.07503248, -0.1118878, -0.019752674, 0.16568772, -0.044683784, -0.15678827 }, { 0.13998933, 0.23558556, 0.28396693, -0.101323254, 0.13112107, -0.029578874, -0.2022097, -0.24576688, -0.09638763, -0.26200497, 0.008860207, -0.061708033, -0.09214497, -0.1835404, -0.1674263, 0.1231941 }, { 0.15461478, 0.112559065, 0.07977586, -0.010172801, 0.02354518, -0.22292472, -0.121908806, 0.15824343, -0.07791999, 0.036430042, -0.07320335, 0.01587939, -0.23789081, 0.07284255, 0.0071846657, -0.1481774 }, { 0.11088579, -0.0053850636, -0.10257444, 0.073907875, 0.16827318, 0.022582695, 0.18004529, 0.084441386, 0.0015668245, -0.31266516, 0.19253156, 0.076823294, -0.17149054, 0.026093027, -0.011765519, -0.044688478 }, { 0.07658623, 0.063996255, -0.12240239, -0.15891878, -0.081210814, 0.033824638, 0.13882332, 0.18556374, -0.04039441, -0.11795138, -0.043519158, -0.19298877, 0.16672675, 0.05832604, 0.064755425, 0.07025756 }, { 0.17483206, 0.19336699, -0.04624127, -0.034067146, 0.014948278, -0.0831799, 0.17367825, -0.046823114, 0.050205156, -0.06496277, -0.1691285, -0.10218173, -0.073679574, 0.13133562, 0.061516095, 0.09297014 }, { -0.05765264, -0.2086422, 0.21255496, -0.16149214, 0.18545522, -0.041922543, -0.026366076, 0.13573189, 0.15629442, -0.0018575843, 0.1054523, -0.027984377, -0.20949836, -0.1326756, 0.192212, -0.045585304 }, { 0.1365882, 0.16518861, -0.098852724, 0.15903717, 0.03130202, 0.064491406, 0.09991292, -0.097731754, -0.06519217, -0.00581822, -0.008380908, -0.21452267, 0.2095595, 0.18439026, -0.062075187, 0.26284155 }, { -0.16195443, 0.08827007, 0.08527384, 0.1600074, -0.11671723, -0.0073247887, 0.03439791, 0.010642655, -0.08402233, -0.038626455, -0.13673803, -0.45269716, 0.051114198, 0.23010722, -0.034992013, 0.22716528 }, { -0.04405286, 0.13598277, 0.093084455, -0.09815186, 0.060869653, 0.1455809, 0.031465806, 0.20357192, 0.096961655, -0.16107689, -0.20117173, -0.29680064, -0.06843072, -0.11434737, 0.24609032, -0.026169838 }, { 0.07823583, 0.011461079, -0.2575128, 0.148633, 0.08452563, -0.1354103, 0.31743494, -0.09959024, 0.030729026, -0.052148823, 0.13078235, 0.18432422, -0.13955744, -0.051789958, -0.21622078, -0.043035094 }, { 0.013783152, 0.067399114, -0.08346887, -0.27402213, 0.13888237, 0.044861693, -0.0340352, 0.063006535, -0.09279301, 0.06415106, 0.17200004, 0.05396612, -0.17121895, -0.28569934, -0.06002395, 0.10059767 }, { -0.122785896, 0.026146835, -0.076166846, -0.05095239, -0.08961194, -0.057664644, -0.18163809, 0.23730509, 0.0345265, -0.23905617, 0.032345995, 0.042010523, -0.16796684, 0.21458516, -0.033173144, 0.00070899155 }, { 0.020936703, -0.005158556, 0.054145474, 0.12227796, -0.008437896, -0.08287982, 0.20855205, 0.02826738, 0.18830213, 0.19430606, 0.1550211, -0.039352287, -0.21549807, 0.01581711, -0.16695039, -0.032282896 }, { 0.21679479, -0.39249778, 0.21783952, 0.1401575, 0.12759052, -0.11665134, -0.24013461, -0.041222192, 0.009362774, -0.059089884, -0.0539839, 0.19631758, 0.19202918, -0.14406575, 0.12198337, 0.04297159 } },
    .layers_2_bias = { 0.042258862, -0.06911895, 0.35427606, -0.22106141, -0.061492205, 0.6396943, -0.0256824, 0.07536992, 0.17244767, -0.24259579, 0.11539976, 0.09927446, -0.11222102, -0.09888225, 0.31386265, -0.28457588 },
    .layers_2_activation = { 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0. },
    .layers_4_weight = { { 0.08016178, 0.098929696, 0.16610366, 0.14201039, -0.21446206, 0.042172972 }, { -0.10165202, -0.21276444, 0.005356969, -0.08810695, 0.15493304, -0.04893691 }, { 0.07016061, 0.17763922, -0.022219917, 0.10962521, 0.059653323, -0.08065477 }, { -0.12813301, -0.097559415, -0.023886107, 0.3110074, -0.10225869, -0.056970928 }, { -0.0095156105, 0.058041133, -0.17148007, -0.11106557, -0.06767173, 0.12517779 }, { 0.12350529, 0.16579212, 0.28956684, -0.0926364, 0.05821559, -0.19793658 }, { 0.039216533, 0.13840273, -0.1926354, 0.088922694, -0.005970185, -0.0074683204 }, { -0.17735866, 0.024254056, 0.14395858, -0.06680592, 0.016850907, -0.18512885 }, { 0.059701618, -0.021498727, 0.14537127, -0.0049428702, -0.011358503, 0.05129257 }, { -0.13415474, 0.04625813, -0.0199095, 0.04505555, -0.24969721, 0.016205693 }, { 0.25511107, -0.18006086, 0.113458335, 0.09864151, 0.13577878, 0.0015129588 }, { 0.2089422, 0.18380336, -0.0772069, -0.092484504, 0.27463713, -0.036452945 }, { -0.22767228, 0.024787461, -0.17943993, -0.06271281, 0.021500321, -0.0017270664 }, { 0.16087963, -0.00828012, -0.13008888, -0.1379637, -0.028006574, 0.16409515 }, { 0.3008973, -0.115758836, -0.08766875, 0.2142122, 0.0348471, 0.17366743 }, { -0.2768903, 0.07439424, -0.34367755, 0.13768235, 0.03191729, 0.17194667 } },
    .layers_4_bias = { 0.24307823, 0.3400518, 0.08036605, -0.06123073, -0.027138222, -0.30902612 },
    .layers_4_activation = { 0., 0., 0., 0., 0., 0. },
    .scaled_output = { 0., 0., 0., 0., 0., 0. },
    .mins = { -4.134644442689419, -5.913845286679268, -3.7609597561359407, -0.035765885026194155, -0.050201853839098476, -0.029192359070293605 },
    .maxs = { 1.2893420945167542, 2.0867967246055605, 1.8642123750686646, 0.035134838661178946, 0.04446218235534616, 0.07815751343150623 },
};

const float* nn_forward(float input[INPUT_SIZE]) {
    layer(12, 16, input, mlp.layers_0_weight, mlp.layers_0_bias, mlp.layers_0_activation, 1);
    layer(16, 16, mlp.layers_0_activation, mlp.layers_2_weight, mlp.layers_2_bias, mlp.layers_2_activation, 1);
    layer(16, 6, mlp.layers_2_activation, mlp.layers_4_weight, mlp.layers_4_bias, mlp.layers_4_activation, 0);
    for (int i = 0; i < 6; i++) {
        mlp.scaled_output[i] = (mlp.layers_4_activation[i] + 1) * 0.5f * (mlp.maxs[i] - mlp.mins[i]) + mlp.mins[i];
    }
    return mlp.scaled_output;
};
